<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="courses_main_custom" name="Custom main course" inherit_id="website_slides.course_main" priority="17">
        <xpath expr="//div[@id='wrap']" position="replace">

            <div class="oe_structure oe_empty">
                <t t-set="_record" t-value="channel"/>
                <t t-set="use_size" t-value="True"/>
                <t t-set="use_text_align" t-value="True"/>
                <div t-attf-class="o_wslides_course_header position-relative pb-md-0 #{'pb-3' if channel.channel_type == 'training' else 'o_wslides_course_doc_header pb-5'}">
                    <t t-call="website_slides.course_nav"/>
                    <div class="custom_wslides_course_header">
                        <div class="container">
                            <div class="row">
                                <div class="col-12 col-md-4 col-lg-3 position-relative">
                                    <div class="d-none d-md-flex align-items-end justify-content-around h-100">
                                        <div t-field="channel.image_1920" t-options="{'widget': 'image', 'class': 'o_wslides_course_pict d-inline-block mb-2 mt-3 my-md-0 custom-image', 'preview_image': 'image_1024'}" class="h-100"/>
                                        <div class="overlay-icon">
                                            <button role="button" class="btn btn-link" title="Share Channel" aria-label="Share Channel" data-bs-toggle="modal" t-att-data-bs-target="'#slideShareModal_%s' % channel.id">
                                                <img src="/theme_academy/static/src/img/ios_share.png" alt="Icon" class="icon"/>
                                            </button>
                                        </div>
                                    </div>
                                </div>


                                <div class="col-12 col-md-8 col-lg-9 d-flex flex-column header-text">
                                    <div class="d-flex flex-column">
                                        <h1 t-field="channel.name" class="custom_course_name"/>
                                        <div class="mb-0 mb-xl-3 custom_course_description" t-field="channel.description"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <t t-call="website_slides.slide_share_modal">
                <t t-set="record" t-value="channel"/>
                <t t-set="slide_share_modal_title">Share This Course</t>
                <t t-set="website_share_url" t-value="channel.website_url"/>
            </t>

            <div class="o_wslides_course_main custom_wslides_course_main">
                <div class="container mb-5">
                    <div class="row">
                        <div class="col-12 col-md-4 col-lg-3 mt-3 mt-md-0 custom_sidebar">
                            <t t-call="eLearning_upgraded.custom_course_sidebar" />
                        </div>
                        <div class="col-12 col-md-8 col-lg-9 position-relative">
                            <ul class="nav nav-tabs o_wslides_nav_tabs flex-nowrap" role="tablist" id="profile_extra_info_tablist">
                                <li class="nav-item" role="presentation">
                                    <a t-att-class="'nav-link %s' % ('active' if active_tab == 'home' else '')" id="home-tab" data-bs-toggle="pill" href="#home" role="tab" aria-controls="home" t-att-aria-selected="'true' if active_tab == 'home' else 'false'">
 Course
                                    </a>
                                </li>
                                <li class="nav-item o_wslides_course_header_nav_review" role="presentation">
                                    <a t-att-class="'nav-link %s' % ('active' if active_tab == 'review' else '')" id="review-tab" data-bs-toggle="pill" href="#review" role="tab" aria-controls="review" t-att-aria-selected="'true' if active_tab == 'review' else 'false'">
                                        Reviews
                                    </a>
                                </li>
                            </ul>

                            <div class="tab-content py-4 o_wslides_tabs_content mb-4" id="courseMainTabContent">
                                <div t-att-class="'tab-pane fade %s' % ('show active' if active_tab == 'home' else '')" id="home" role="tabpanel" aria-labelledby="home-tab">

                                    <div t-if="access_error == 'course_content'" class="alert alert-danger alert-dismissable mb-1" role="alert">
                                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"/>
                                        You need to join this course to access "<t t-out="access_error_content_name"/>
".
                                    </div>

                                    <div t-if="invite_preview" class="o_wslides_identification_banner alert alert-success mb-4 p-2 px-3" role="alert">
                                        You have been invited to this course.
                                        <a class="o_underline" t-attf-href="/slides/#{channel.id}/identify?#{keep_query('invite_partner_id', 'invite_hash')}">
                                            <t t-if="is_partner_without_user">Sign up</t>
                                            <t t-else="">Log in</t>
                                        </a> to browse preview content and enroll.
                                    </div>

                                    <t t-if="channel.channel_type == 'training'" t-call="website_slides.course_slides_list"/>
                                    <t t-else="">

                                        <!-- Featured lesson  -->
                                        <t t-if="channel.promote_strategy != 'none'">
                                            <t t-call="website_slides.course_promoted_slide"/>
                                        </t>

                                        <div class="container py-2">


                                            <t t-foreach="category_data" t-as="category">
                                                <div class="mb-2" t-if="(category['slides'] or channel.can_publish) and (search_category and search_category.id == category['id'] or not search_category)">
                                                    <t t-set="is_empty_editable" t-value="not category['slides'] and channel.can_publish"/>
                                                    <div class="d-flex align-items-center justify-content-between border-bottom pb-2 mb-3" t-if="category['id'] and query_string != '?search_uncategorized=1'">
                                                        <h5 t-attf-class="m-0 #{'text-muted' if is_empty_editable else ''}">
                                                            <t t-esc="category['name']"/>
                                                        </h5>
                                                        <a t-if="category['id'] and not is_empty_editable" t-attf-href="/slides/#{channel.id}/category/#{category['id']}?#{keep_query('invite_hash', 'invite_partner_id') if invite_preview else ''}">View all</a>
                                                    </div>
                                                    <div class="d-flex align-items-center justify-content-between border-bottom pb-2 mb-3" t-if="not category['id'] and len(category['slides']) &gt; 0">
                                                        <h5 t-if="len(category_data) &gt; 1" t-attf-class="m-0 #{'text-muted' if is_empty_editable else ''}">
                                                            <t t-esc="category['name']"/>
                                                        </h5>
                                                        <a t-attf-href="/slides/#{channel.id}?uncategorized=1&amp;#{keep_query('invite_hash', 'invite_partner_id') if invite_preview else ''}">View all</a>
                                                    </div>
                                                    <div class="row mx-n2">
                                                        <t t-foreach="category['slides']" t-as="slide">
                                                            <div class="col-12 col-sm-6 col-lg-4 px-2 d-flex" t-call="website_slides.lesson_card"/>
                                                        </t>
                                                    </div>
                                                </div>
                                            </t>

                                            <div class="row">
                                                <div class="col" t-field="channel.description_html"/>
                                            </div>
                                        </div>
                                        <t t-if="search_category or search_uncategorized">
                                            <div class="d-flex justify-content-center pb-5">
                                                <t t-call="website_profile.pager_nobox"/>
                                            </div>
                                        </t>
                                    </t>

                                </div>
                                <div t-if="channel.allow_comment" t-att-class="'tab-pane fade %s' % ('show active' if active_tab == 'review' else '')" id="review" role="tabpanel" aria-labelledby="review-tab">
                                    <div class="custom_review_component">
                                        <t t-call="portal.message_thread">
                                            <t t-set="object" t-value="channel"/>
                                            <t t-set="hash" t-value="message_post_hash"/>
                                            <t t-set="pid" t-value="message_post_pid"/>
                                            <t t-set="display_rating" t-value="True"/>
                                            <t t-set="disable_composer" t-value="True"/>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </xpath>
    </template>

</odoo>